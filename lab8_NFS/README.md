# Лабораторная работа №8

## Задача
>1. Добавить к предыдущему Vagrantfile еще один сервер NFS с дополнительным диском. На этом сервере настроить шаринг папки с помощью NFS на сервера с БД. На серверах БД эта папка должна быть примонтирована по пути /pgsql/pg_backup
>2. Настроить архивирование WAl файлов с помощью утилиты pg_probackup
>3. Все операции должны выполняться через плейбук



## Как запустить Ansible-сценарий

1. Склонировать репозиторий
``` 
git clone https://github.com/dif-dif/ansible.git 
```
2. Открыть в терминале папку lab8_nfs
3. Отредактировать в Vagrantfile ip адреса (при необходимости) и путь до вашего публичного ssh ключа
>("/home/sirius/.ssh/id_rsa.pub")
3. Поднять виртуалку
```
vagrant status (убеждаемся что машины существуют, но не запущены)
vagrant up
```
4. Запустить плейбук
```
ansible-playbook pg.yml
```

### Скриншоты работоспособности
- Заходим на ноду, убеждаемся, что patroni и система бэкапов работает
![Статус](https://github.com/dif-dif/ansible/blob/master/pictures/lab8_1.png)
